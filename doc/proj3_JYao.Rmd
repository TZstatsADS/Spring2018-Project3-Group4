---
title: "proj3"
author: "Jingtian Yao"
date: "March 14, 2018"
output: html_document
---

## Construct RGB Features

```{r}
set.seed(1)
source("../lib/featureRGB.R")

img_dir <- "../data/train/train/images/"

time <- system.time(rgb_feature <- featureRGB(img_dir,export = T))

#rgb_feature <- featureRGB(img_dir,export = T)

cat("Time for constructing RGB features is",time[3],"s \n")

labeldata <- read.csv("../data/train/train/label_train.csv")
rgb_feature$label <- labeldata$label

trainimg <- sample(1:3000,2100)
testimg <- setdiff(1:3000,trainimg)
train.rgb <- rgb_feature[trainimg,]
test.rgb <- rgb_feature[testimg,]

write.csv(train.rgb,file = "../output/rgbftr_train.csv")

write.csv(test.rgb,file = "../output/rgbftr_test.csv")

```

## XGboost based on RGB features

```{r}
source("../lib/xgb.R")
cv_rgb <- xgb_param(train.rgb,5)

param <- cv_rgb$best_param
model <- xgb_model(train.rgb,param)
pred <- xgb_pred(model, test.rgb)
pred$err
```


## Xgboost based on SIFT features

```{r}
sift_feature <- read.csv("../data/train/train/SIFT_train.csv",header = F)
sift_feature$label <- labeldata$label
sift_feature <- sift_feature[,-1]

train.sift <- sift_feature[trainimg,]
test.sift <- sift_feature[testimg,]

model2 <- xgb_model(train.sift,param)
pred2 <- xgb_pred(model2, test.sift)
pred2$err

```


